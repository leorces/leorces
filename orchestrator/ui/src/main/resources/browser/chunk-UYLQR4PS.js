import{a as j}from"./chunk-G5V2YYDH.js";import{a as k}from"./chunk-MN3F5VON.js";import{a as z}from"./chunk-7XBG6V2W.js";import{a as O}from"./chunk-2DE5BC62.js";import{a as $}from"./chunk-YVYARSZY.js";import{A as T,B as I,E as L,F as w,G as c,H as e,I as t,J as g,N as M,P as m,R as u,X as n,Y as E,Z as h,aa as N,ba as F,d as S,ga as _,h as C,i as D,j as y,o as v,p as P,q as x,s as d,v as o,x as f}from"./chunk-B4JCPXUQ.js";var H=(s,r)=>r.id;function K(s,r){s&1&&(e(0,"div",0)(1,"div",4)(2,"span",5),n(3,"Loading..."),t()()())}function U(s,r){if(s&1&&(e(0,"div",1),g(1,"i",6),n(2),t()),s&2){let i=u();o(2),h(" ",i.error()," ")}}function R(s,r){s&1&&(e(0,"div",2),g(1,"i",7),e(2,"h5",8),n(3,"No definitions found"),t(),e(4,"p",9),n(5,"There are no process definitions to display."),t()())}function q(s,r){if(s&1){let i=M();e(0,"tr")(1,"td")(2,"a",11),m("click",function(){let p=P(i).$implicit,l=u(2);return x(l.viewDetails(p.id))}),n(3),t()(),e(4,"td"),n(5),t(),e(6,"td"),g(7,"app-state-badge",12),t(),e(8,"td")(9,"a",11),m("click",function(){let p=P(i).$implicit,l=u(2);return x(l.viewDefinitionDetails(p.definition.id))}),n(10),t()(),e(11,"td"),n(12),N(13,"dateFormat"),t()()}if(s&2){let i=r.$implicit;o(3),h(" ",i.id," "),o(2),E(i.businessKey),o(2),c("state",i.state),o(3),h(" ",i.definition.name," "),o(2),E(F(13,5,i.startedAt))}}function G(s,r){if(s&1&&(e(0,"div",3)(1,"table",10)(2,"thead")(3,"tr")(4,"th"),n(5,"ID"),t(),e(6,"th"),n(7,"Business Key"),t(),e(8,"th"),n(9,"State"),t(),e(10,"th"),n(11,"Definition"),t(),e(12,"th"),n(13,"Started"),t()()(),e(14,"tbody"),L(15,q,14,7,"tr",null,H),t(),e(17,"tfoot")(18,"tr")(19,"td")(20,"strong"),n(21,"ID"),t()(),e(22,"td")(23,"strong"),n(24,"Business Key"),t()(),e(25,"td")(26,"strong"),n(27,"State"),t()(),e(28,"td")(29,"strong"),n(30,"Definition"),t()(),e(31,"td")(32,"strong"),n(33,"Started"),t()()()()()()),s&2){let i=u();o(15),w(i.processes())}}var b=class s{processes=_([]);loading=_(!1);error=_(null);router=v(z);viewDetails(r){this.router.toProcess(r)}viewDefinitionDetails(r){this.router.toDefinition(r)}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=f({type:s,selectors:[["app-process-list-table"]],inputs:{processes:[1,"processes"],loading:[1,"loading"],error:[1,"error"]},decls:4,vars:1,consts:[[1,"d-flex","justify-content-center","align-items-center","py-5"],["role","alert",1,"alert","alert-danger"],[1,"text-center","py-5"],["role","grid","aria-describedby","dataTable_info",1,"table-responsive","table","small","mt-2"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"bi","bi-exclamation-triangle-fill","me-2"],[1,"bi","bi-inbox","display-4","text-muted"],[1,"mt-3","text-muted"],[1,"text-muted"],[1,"table","my-0"],["href","javascript:void(0)","title","View Process Details",1,"text-primary","text-decoration-none",3,"click"],[3,"state"]],template:function(i,a){i&1&&T(0,K,4,0,"div",0)(1,U,3,1,"div",1)(2,R,6,0,"div",2)(3,G,34,0,"div",3),i&2&&I(a.loading()&&a.processes().length===0?0:a.error()?1:a.processes().length===0?2:3)},dependencies:[O,$],encapsulation:2})};var V=class s{processes=d([]);loading=d(!1);error=d(null);currentPage=d(1);pageSize=d(10);totalItems=d(0);filter=d("");stateFilter=d("all");processService=v(j);destroy$=new S;searchSubject=new S;constructor(){this.searchSubject.pipe(C(300),D(),y(this.destroy$)).subscribe(r=>{this.filter.set(r),this.currentPage.set(1),this.loadProcesses()})}ngOnInit(){this.loadProcesses()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onStateFilterChange(r){let i=r.target;this.stateFilter.set(i.value),this.currentPage.set(1),this.loadProcesses()}onFilterChange(r){let i=r.target;this.searchSubject.next(i.value)}onPageChange(r){this.currentPage.set(r),this.loadProcesses()}onPageSizeChange(r){let i=r.target,a=parseInt(i.value,10);this.pageSize.set(a),this.currentPage.set(1),this.loadProcesses()}loadProcesses(){this.loading.set(!0);let r={page:this.currentPage()-1,size:this.pageSize(),filter:this.filter(),state:this.stateFilter(),sortByField:"created_at",order:"DESC"};this.processService.findAll(r).subscribe({next:i=>{this.loading.set(!1),this.processes.set(i.data),this.totalItems.set(i.total)},error:i=>{this.loading.set(!1),this.error.set("Failed to load definitions. Please try again later...")}})}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=f({type:s,selectors:[["app-process-list"]],decls:35,vars:9,consts:[[1,"container","pt-5"],[1,"text-dark","mb-4"],[1,"row"],[1,"col-md-6","text-nowrap"],[1,"form-label"],[1,"d-inline-block","form-select","form-select-sm",3,"change","value"],["value","10"],["value","25"],["value","50"],["value","100"],[1,"col-md-6"],[1,"text-md-end","d-flex","gap-2","justify-content-md-end"],[1,"form-select","form-select-sm",2,"width","auto",3,"change","value"],["value","all"],["value","ACTIVE"],["value","COMPLETED"],["value","CANCELED"],["value","INCIDENT"],["id","search-filter","placeholder","Search","type","search",1,"form-control","form-control-sm",3,"input","value"],[3,"error","loading","processes"],[3,"pageChange","currentPage","pageSize","totalItems"]],template:function(i,a){i&1&&(e(0,"main",0)(1,"h3",1),n(2,"Process executions"),t(),e(3,"div")(4,"div",2)(5,"div",3)(6,"label",4),n(7,"Show "),e(8,"select",5),m("change",function(l){return a.onPageSizeChange(l)}),e(9,"option",6),n(10,"10"),t(),e(11,"option",7),n(12,"25"),t(),e(13,"option",8),n(14,"50"),t(),e(15,"option",9),n(16,"100"),t()()()(),e(17,"div",10)(18,"div",11)(19,"label",4)(20,"select",12),m("change",function(l){return a.onStateFilterChange(l)}),e(21,"option",13),n(22,"All States"),t(),e(23,"option",14),n(24,"Active"),t(),e(25,"option",15),n(26,"Completed"),t(),e(27,"option",16),n(28,"Canceled"),t(),e(29,"option",17),n(30,"Incident"),t()()(),e(31,"label",4)(32,"input",18),m("input",function(l){return a.onFilterChange(l)}),t()()()()(),g(33,"app-process-list-table",19),e(34,"app-pagination",20),m("pageChange",function(l){return a.onPageChange(l)}),t()()()),i&2&&(o(8),c("value",a.pageSize()),o(12),c("value",a.stateFilter()),o(12),c("value",a.filter()),o(),c("error",a.error())("loading",a.loading())("processes",a.processes()),o(),c("currentPage",a.currentPage())("pageSize",a.pageSize())("totalItems",a.totalItems()))},dependencies:[k,b],styles:["#search-filter[_ngcontent-%COMP%]{width:15rem}"]})};export{V as ProcessList};
